pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
--level manager

levels={}
current_lvl_name='collection'
	
function _init()
	poke(0x5f2d,1)
	init_game_lvl()
	init_collection_level()
end

function _update60()
	local current=get_current_lvl()
	
	if current and current.update then
		current.update()
	end
	
	update_mouse()
end

function _draw()
	cls()
	local current=get_current_lvl()
	
	if current and current.draw then
		current.draw()
	end
	
	draw_mouse()
end

function add_level(lvl)
	add(levels,lvl)
end

function get_current_lvl()
	for lvl in all(levels) do
		if lvl.name == current_lvl_name then
			return lvl
		end
	end
	
	return nil
end

-->8
--game level

function init_game_lvl()
	add_level({
		name='game',
		update=update_game,
		draw=draw_game
	})
end

function update_game()
	
end

function draw_game()
	--draw_number(0,0,❎1,1)
	--draw_number(0,8,❎2,2)
	--draw_number(0,16,❎3,3)
	--draw_number(0,24,❎4,4)
	--draw_number(0,32,❎5,5)
	--draw_number(0,40,❎6,6)
	--draw_number(0,48,❎7,7)
	--draw_number(0,56,❎8,8)
	--draw_number(0,64,❎9,9)
	--draw_number(0,72,❎0,10)
	
	draw_card(60,60,silver,❎6)
end
-->8
--numbers

❎1={sx=0,sy=0,sw=5,sh=7}
❎2={sx=6,sy=0,sw=5,sh=7}
❎3={sx=12,sy=0,sw=5,sh=7}
❎4={sx=18,sy=0,sw=5,sh=7}
❎5={sx=24,sy=0,sw=5,sh=7}
❎6={sx=30,sy=0,sw=5,sh=7}
❎7={sx=36,sy=0,sw=5,sh=7}
❎8={sx=42,sy=0,sw=5,sh=7}
❎9={sx=48,sy=0,sw=5,sh=7}
❎0={sx=54,sy=0,sw=5,sh=7}
❎qm={sx=60,sy=0,sw=5,sh=7}

function draw_number(x,y,num,col)
	pal(7,col)
	sspr(
		num.sx,
		num.sy,
		num.sw,
		num.sh,
		x,
		y
	)
	pal()
end
-->8
--cards

function draw_card(x,y,frame,num)
	sspr(
		frame.sx,
		frame.sy,
		frame.sw,
		frame.sh,
		x,
		y
	)
	
	draw_number(
		x+2,
		y+3,
		num,
		frame.col
	)
end
-->8
--frames

bronze={sx=0,sy=8,sw=9,sh=13,col=9}
silver={sx=10,sy=8,sw=9,sh=13,col=6}
gold={sx=20,sy=8,sw=9,sh=13,col=10}
-->8
--collection

collection={}

function init_collection_level()
	add_level({
		name='collection',
		update=update_collection,
		draw=draw_collection
	})
	
	add_card_to_collection({frame=bronze,number=❎1})
	add_card_to_collection({frame=silver,number=❎3})
	add_card_to_collection({frame=bronze,number=❎4})
	add_card_to_collection({frame=gold,number=❎9})
end

function update_collection()
	
end

function draw_collection()
	local x_index=0
	local y_index=0
	local card_width=10
	local card_height=8
	
	for card in all(collection) do
		draw_card(
			x_index*card_width,
			y_index*card_height,
			card.frame,
			card.number
		)
		
		x_index += 1
	end
end

function add_card_to_collection(card)
	add(collection,card)
end
-->8
--mouse

mouse_x=0
mouse_y=0

function update_mouse()
	mouse_x=stat(32)
	mouse_y=stat(33)
end

function draw_mouse()
	spr(48,mouse_x,mouse_y)
end

function get_clicked_element(elements)
	for element in all(elements) do
		if (
			mouse_x > element.x and
			mouse_x < element.x + element.w and
			mouse_y > element.y and
			mouse_y < element.y + element.h
		) then
			return element
		end
	end
	
	return nil
end
__gfx__
00700807770807770800077877777800770877777807770807770807770807770800000000000000000000000000000000000000000000000000000000000000
07700870007870007800707870000807000800007870007870007870007870007800000000000000000000000000000000000000000000000000000000000000
00700800007800007807007877770870000800070870007870007870077800007800000000000000000000000000000000000000000000000000000000000000
00700800770807770870007800007877770800700807770807777870707800070800000000000000000000000000000000000000000000000000000000000000
00700807000800007877777800007870007807000870007800007877007800700800000000000000000000000000000000000000000000000000000000000000
00700870000870007800007870007870007807000870007800070870007800000800000000000000000000000000000000000000000000000000000000000000
00700877777807770800007807770807770807000807770807700807770800700800000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
999999999006666666000aaaaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000000906600000660a0a000a0a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000000906000000060aa00000aa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000000906000000060a0000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000000906000000060a0000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000000906000000060a0000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000000906000000060a0000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000000906000000060a0000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000000906000000060a0000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000000906000000060a0000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000000906000000060aa00000aa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000000906600000660a0a000a0a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
999999999006666666000aaaaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
17100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
17710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
17771000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
17777100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
17711000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01171000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
